function chooseAll(B){var A;aColl=document.all.tags("input");for(A=0;A<aColl.length;A++){whichA=aColl(A);if(whichA.name=="checkbox"){whichA.checked=B}}}var strCurrentTrId="tr0";function changeRowCss(strId){if(eval(strId+".className == 'trDetail'")){if(eval("typeof("+strCurrentTrId+")")!="undefined"){eval(strCurrentTrId+".className = 'trDetail'")}eval(strId+".className = 'trSelected'");strCurrentTrId=strId}}var strCurrentScrollTrId="tr0";function changeScrollRowCss(strId){if(eval(strId+".className == 'RelativeTag'")){if(eval("typeof("+strCurrentTrId+")")!="undefined"){eval(strCurrentTrId+".className = 'RelativeTag'")}eval(strId+".className = 'RelativeTagSelected'");strCurrentTrId=strId}}function openModalDialog(B,A){window.showModalDialog(B,window,A)}function openDialog(B,A){window.open(B,"window",A)}function setSelected(C,B){var A;for(A=0;A<C.length;A++){if(C.options[A].value==B){C.options[A].selected=true;break}}}function inputNumber(B){var A=event.keyCode;if((A<48||A>57)&&A!=45){event.keyCode=0}}function inputNumber2(B){var A=event.keyCode;if(((A<48||A>57)&&A!=45&&A!=46)||(A==46&&B.value.indexOf(String.fromCharCode(46))>=0||A==45&&B.value.indexOf(String.fromCharCode(45))>=0)){event.keyCode=0}}function getSelectedValue(B){var F="";var A=document.all.tags("input");var E;var C=new Array();for(var D=0;D<A.length;D++){E=A(D);if(E.name=="checkbox"&&E.checked){C=E.value.split("|");F+=C[B]+","}}return F="("+F+"-1)"}function getSelectedValues(B){var F="";var A=document.all.tags("input");var E;var C=new Array();for(var D=0;D<A.length;D++){E=A(D);if(E.name=="checkbox"&&E.checked){C=E.value.split("|");F+="'"+C[B]+"',"}}return F="("+F+"'-1')"}function GetIds(){var A,B;B="(";aColl=document.all.tags("input");for(A=0;A<aColl.length;A++){whichA=aColl(A);if(whichA.name=="checkbox"){if(whichA.checked){B=B+"'"+whichA.value+"',"}}}return B=B+"'-1')"}function GetId(){var A,B;B="(";aColl=document.all.tags("input");for(A=0;A<aColl.length;A++){whichA=aColl(A);if(whichA.name=="checkbox"){if(whichA.checked){B=B+whichA.value+","}}}return B=B+"-1)"}function GetId2(){var A,B;B="(";aColl=document.all.tags("input");for(A=0;A<aColl.length;A++){whichA=aColl(A);if(whichA.name=="checkbox"){if(!whichA.checked){B=B+whichA.value+","}}}return B=B+"-1)"}function GetFileId(){var A,B;B="(";aColl=document.all.tags("input");for(A=0;A<aColl.length;A++){whichA=aColl(A);if(whichA.name=="checkbox"){if(whichA.checked){B=B+whichA.value.substr(0,whichA.value.indexOf("|"))+","}}}return B=B+"-1)"}function DeleteDo(A,C){if(C=="(-1)"){alert("请选择要删除的记录!");return false}if(window.confirm("确定要删除吗？")){var B;B=new String(window.location);B=B.replace(/\&/gi,"|");document.location="../common/delete_record.asp?table="+A+"&idset="+C+"&url="+B}}function DeleteDo2(B,E,A,C){if(E=="(-1)"){alert("请选择要删除的记录!");return false}if(window.confirm("确定要删除吗？")){var D;D=A;D=D.replace(/\&/gi,"|");document.location="../common/delete_record.asp?table="+B+"&idset="+E+"&url="+D+"&target="+C}}function DeleteFileDo(A,C){if(C=="(-1)"){alert("请选择要删除的文件。");return false}if(window.confirm("确定要删除吗？")){var B;B=new String(window.location);B=B.replace(/\&/gi,"|");document.location="../file/delete_file.asp?table="+A+"&idset="+C+"&url="+B}}function DeleteImage(A){if(A=="(-1)"){alert("请选择要删除的图片。");return false}if(window.confirm("确定要删除吗？")){document.location="../album/delete.asp?idset="+A}}function ChangePos(){Layer1.style.left=(document.body.clientWidth-250)/2;Layer1.style.top=document.body.clientHeight-45+document.body.scrollTop}function OpenEditor(B,C,A){window.open("../common/edit_content.asp?caption="+B+"&table="+C+"&id="+A,"Editor_page","resizable=yes,status=yes,width=650,height=500")}function BuildPage(A){if(A=="(-1)"){alert("请选择要生成的记录!");return false}window.open(" ../page/build.asp?idset="+A,"build_page","resizable=yes,width=380,height=230,scrollbars=yes,")}function GetImages(){var C,E,B,D,A,F;A=".jpg, .jpeg, .bmp, .gif, .png";F="";E="";aColl=document.all.tags("input");for(C=0;C<aColl.length;C++){whichA=aColl(C);if((whichA.name=="checkbox")&&(whichA.checked)){B=whichA.value.substr(whichA.value.indexOf("|")+1,whichA.value.lastIndexOf("|")-whichA.value.indexOf("|")-1);D=B.substr(B.lastIndexOf("."),B.length);F=whichA.value.substr(whichA.value.lastIndexOf("|")+1,whichA.value.length-whichA.value.lastIndexOf("|"));if(F==""){F=B}if(A.indexOf(D.toLowerCase())!=-1){E=E+"<img src='"+B+"'>"}else{E=E+"<a href='"+B+"' target='_blank'>附件："+F+"</a>"}}}return E=E+""}function IsDate(A,B,C){switch(parseInt(B)){case 1:case 3:case 5:case 7:case 8:case 10:case 12:if(parseInt(C)>31){return false}break;case 4:case 6:case 9:case 11:if(parseInt(C)>30){return false}break;case 2:if(((A%4==0&&A%100!=0)||(A%400==0))&&parseInt(C)<=29){return true}else{if(parseInt(C)<=28){return true}else{return false}}break;default:return false}return true}function SplitData(D){var A=102399;var C=new String;C=D.value;if(C.length>A){D.value=C.substr(0,A);C=C.substr(A);while(C.length>0){var B=document.createElement("TextArea");B.name="fd0";B.value=C.substr(0,A);document.frmEditor.appendChild(B);C=C.substr(A)}}}function OpenModalDialog(F,C,A,B){var D=(window.screen.height-A)/2;var E=(window.screen.width-C)/2;window.showModalDialog(F,window,"dialogHeight:"+A+"px; dialogWidth:"+C+"px; dialogTop:"+D+"px; dialogLeft:"+E+";"+B)}function OpenDialog(F,C,A,B){var D=(window.screen.height-A)/2;var E=(window.screen.width-C)/2;window.open(F,"Open_Dialog","height="+A+",width="+C+",top="+D+",left="+E+","+B)}function GetRadioId(){var A,B;B="(";aColl=document.all.tags("input");for(A=0;A<aColl.length;A++){whichA=aColl(A);if(whichA.name=="radiobutton"){if(whichA.checked){B+=whichA.value+",";break}}}return B+="-1)"}var strCurrentMenuItemId="0";function GotoMenuItemPage(strId,strUrl){if(eval("MenuItem"+strId+".className=='MenuItemBack1'")){if(eval("typeof(MenuItem"+strCurrentMenuItemId+")")!="undefined"){eval("MenuItem"+strCurrentMenuItemId+".className='MenuItemBack1'")}eval("MenuItem"+strId+".className='MenuItemBack2'");strCurrentMenuItemId=strId;parent.bottomFrame.leftFrame.document.location=strUrl}}var strCurrentTrId="Tr00";function ChangeRowCss(strId){if(eval(strId+".className == 'Tr2'")){if(eval("typeof("+strCurrentTrId+")")!="undefined"){eval(strCurrentTrId+".className = 'Tr2'")}eval(strId+".className = 'Tr3'");strCurrentTrId=strId}if(eval(strId+".className == 'Tr2Hand'")){if(eval("typeof("+strCurrentTrId+")")!="undefined"){eval(strCurrentTrId+".className = 'Tr2Hand'")}eval(strId+".className = 'Tr3Hand'");strCurrentTrId=strId}}function ChangeRowCss2(strId){var i;if(eval(strId+".className == 'RelativeTag'")||eval(strId+".className == 'Tr2'")){for(i=0;i<25;i++){if(eval("typeof("+strCurrentTrId+"Td"+i+")")!="undefined"){if(eval(strCurrentTrId+"Td"+i+".className == 'FixCol2'")){eval(strCurrentTrId+"Td"+i+".className = 'FixCol'")}else{eval(strCurrentTrId+"Td"+i+".className = 'Tr2'")}}if(eval("typeof("+strId+"Td"+i+")")!="undefined"){if(eval(strId+"Td"+i+".className == 'FixCol'")){eval(strId+"Td"+i+".className = 'FixCol2'")}else{eval(strId+"Td"+i+".className = 'Tr3'")}}}}else{if(eval(strId+".className == 'RelativeTagHand'")||eval(strId+".className == 'Tr2Hand'")){for(i=0;i<25;i++){if(eval("typeof("+strCurrentTrId+"Td"+i+")")!="undefined"){if(eval(strCurrentTrId+"Td"+i+".className == 'FixCol2Hand'")){eval(strCurrentTrId+"Td"+i+".className = 'FixColHand'")}else{eval(strCurrentTrId+"Td"+i+".className = 'Tr2Hand'")}}if(eval("typeof("+strId+"Td"+i+")")!="undefined"){if(eval(strId+"Td"+i+".className == 'FixColHand'")){eval(strId+"Td"+i+".className = 'FixCol2Hand'")}else{eval(strId+"Td"+i+".className = 'Tr3Hand'")}}}}}strCurrentTrId=strId}function ReplaceViewTable(B){var A="";A=ReplaceSubString(B.toLowerCase(),"<img ",">",'src=""',"");A=ReplaceSubString(B.toLowerCase(),"<tr ",">","","");A=ReplaceSubString(B.toLowerCase(),"<td ",">","","");return A}function ReplaceSubString(A,B,H,C,E){var J="";var D="";var I="";var G=0;var F=0;if(A==""){return""}D=A;while(D!=""){G=D.indexOf(B);F=D.indexOf(H,G);if(G==-1){J+=D;D="";break}else{if(F==-1){J+=D;D="";break}else{I=D.substring(G,F+H.length);if(C!=""){if(I.indexOf(C)==-1){J+=D.substring(0,F+H.length);D=D.substring(F+H.length,D.length)}else{J+=D.substring(0,G);J+=E;D=D.substring(F+H.length,D.length)}}else{J+=D.substring(0,G);J+=E;D=D.substring(F+H.length,D.length)}}}}return J}function getImageName(B){var A="";if(B.indexOf("filename=")>=0){A=B.substring(B.indexOf("filename=")+9,B.indexOf(".png")+4)}else{A=B}return A}function isDigit(B){var C,A;A=/\d*/i;C=B.match(A);return(C==B)?true:false}function selectDate(B,A){if(A=="atMonth"){new Calendar2().show(B)}else{new Calendar().show(B)}};